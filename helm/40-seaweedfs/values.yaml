# SeaweedFS Configuration - S3 Compatible Object Storage
# SeaweedFS is a simpler, faster alternative to MinIO for distributed object storage

# Global settings
global:
  # Create RBAC resources
  rbac:
    create: true
  
  # Monitoring
  monitoring:
    enabled: true

# Master server configuration (metadata and volume management)
master:
  enabled: true
  replicas: 3  # For high availability
  
  # Resource limits
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 200m
      memory: 256Mi
  
  # Persistence for metadata
  persistence:
    enabled: true
    storageClass: standard
    size: 5Gi
  
  # Service configuration
  service:
    type: ClusterIP
    port: 9333

# Volume server configuration (data storage)
volume:
  enabled: true
  replicas: 3
  
  # Data directories per volume server
  dataDirs:
    - name: data1
      size: 50Gi
      storageClass: standard
  
  # Resource limits
  resources:
    limits:
      cpu: 1000m
      memory: 2Gi
    requests:
      cpu: 500m
      memory: 1Gi
  
  # Service configuration
  service:
    type: ClusterIP
    port: 8080

# Filer configuration (file system interface and S3 API)
filer:
  enabled: true
  replicas: 2
  
  # Enable S3 API
  s3:
    enabled: true
    port: 8333
    # S3 configuration
    config: |
      {
        "identities": [
          {
            "name": "anonymous",
            "credentials": [
              {
                "accessKey": "admin",
                "secretKey": "admin123"
              }
            ],
            "actions": [
              "Admin",
              "Read",
              "Write"
            ]
          }
        ]
      }
  
  # Enable WebDAV (optional)
  webdav:
    enabled: false
  
  # Resource limits
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi
  
  # Persistence for filer metadata
  persistence:
    enabled: true
    storageClass: standard
    size: 10Gi
  
  # Service configuration
  service:
    type: ClusterIP
    port: 8888

# Ingress configuration (optional, for external access)
ingress:
  enabled: false
  # Uncomment and configure for external access
  # className: nginx
  # annotations:
  #   cert-manager.io/cluster-issuer: letsencrypt-prod
  # hosts:
  #   - host: s3.openim.example.com
  #     paths:
  #       - path: /
  #         pathType: Prefix
  #         service:
  #           name: seaweedfs-filer
  #           port: 8333
  # tls:
  #   - secretName: seaweedfs-tls
  #     hosts:
  #       - s3.openim.example.com

# ==============================================================================
# Installation Command:
# helm repo add seaweedfs https://seaweedfs.github.io/seaweedfs/helm
# helm repo update
# helm install seaweedfs seaweedfs/seaweedfs \
#   --namespace seaweedfs --create-namespace \
#   --values helm/40-seaweedfs/values.yaml
# ==============================================================================

# S3 Connection details for OpenIM:
# Endpoint: http://seaweedfs-filer.seaweedfs.svc.cluster.local:8333
# Access Key: admin
# Secret Key: admin123
# Region: us-east-1 (any value works)

# Advantages over MinIO:
# - Simpler architecture (no distributed locking complexity)
# - Better performance for many small files
# - Lower resource consumption
# - S3 API compatible (no code changes)
# - Native file system interface (Filer)

# Trade-offs:
# - Smaller ecosystem than MinIO
# - Fewer enterprise features
# - Less mature S3 compatibility (99% compatible)

# TODO: For production, consider:
# - Changing default S3 credentials (admin/admin123)
# - Enabling TLS for S3 API
# - Setting up ingress for external access
# - Configuring backup and replication
# - Adjusting storage sizes based on workload
# - Consider adding more volume servers for larger deployments
